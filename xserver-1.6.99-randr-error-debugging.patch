From 9e5f2dcdd30c22661760a0a962da44e4acb6a7e3 Mon Sep 17 00:00:00 2001
From: Adam Jackson <ajax@redhat.com>
Date: Mon, 27 Jul 2009 16:52:42 -0400
Subject: [PATCH] additional randr debugging

---
 randr/randr.c |   32 ++++++++++++++++++++++++++++----
 1 files changed, 28 insertions(+), 4 deletions(-)

diff --git a/randr/randr.c b/randr/randr.c
index 1c1d0c4..e4d7cfc 100644
--- a/randr/randr.c
+++ b/randr/randr.c
@@ -477,10 +477,24 @@ RRVerticalRefresh (xRRModeInfo *mode)
 static int
 ProcRRDispatch (ClientPtr client)
 {
+    int ret;
     REQUEST(xReq);
     if (stuff->data >= RRNumberRequests || !ProcRandrVector[stuff->data])
 	return BadRequest;
-    return (*ProcRandrVector[stuff->data]) (client);
+    ret = ProcRandrVector[stuff->data](client);
+    
+    if (ret) {
+        int i;
+        ErrorF("RANDR failure: %d (extension base %d)\n", ret, RRErrorBase);
+        for (i = 0; i < stuff->length; i++) {
+            ErrorF("%08x ", ((unsigned int *)stuff) + i);
+            if ((i+1) % 4 == 0)
+               ErrorF("\n");
+        }
+        ErrorF("\n"); 
+    }
+
+    return ret;
 }
 
 static int
-- 
1.6.3.3

