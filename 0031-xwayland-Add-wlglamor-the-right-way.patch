From a7f4b0f1a49abdb79f7a787e582096af152382c2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Kristian=20H=C3=B8gsberg?= <krh@bitplanet.net>
Date: Fri, 11 Oct 2013 16:29:02 -0700
Subject: [PATCH 31/38] xwayland: Add wlglamor the right way

Defeated by #ifdefs.
---
 hw/xfree86/common/xf86AutoConfig.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/hw/xfree86/common/xf86AutoConfig.c b/hw/xfree86/common/xf86AutoConfig.c
index 523ddb7..4c5d1d5 100644
--- a/hw/xfree86/common/xf86AutoConfig.c
+++ b/hw/xfree86/common/xf86AutoConfig.c
@@ -274,12 +274,12 @@ listPossibleVideoDrivers(char *matches[], int nmatches)
 
 #if !defined(sun)
     /* Fallback to platform default frame buffer driver */
-    if (i < (nmatches - 1)) {
+    if (i < (nmatches - 2)) {
 #ifdef XORG_WAYLAND
-        if (xorgWayland)
+        if (xorgWayland) {
             matches[i++] = xnfstrdup("wlglamor");
             matches[i++] = xnfstrdup("wayland");
-        else
+        } else
 #endif
 #if !defined(__linux__) && defined(__sparc__)
             matches[i++] = xnfstrdup("wsfb");
-- 
1.8.4.2

